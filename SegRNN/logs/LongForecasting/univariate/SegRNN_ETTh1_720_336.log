Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=256, c_out=7, channel_id=0, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=256, data='ETTh1', data_path='ETTh1.csv', dec_in=7, dec_way='pmf', decomposition=0, des='test', devices='0,1', distil=True, do_predict=False, dropout=0.5, e_layers=2, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.05, features='S', freq='h', gpu=1, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=0, learning_rate=0.0005, loss='mse', lradj='type3', model='SegRNN', model_id='ETTh1_720_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=5, pct_start=0.3, pred_len=336, random_seed=2024, revin=0, rnn_type='gru', root_path='./dataset/', seg_len=48, seq_len=720, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, win_len=48)
Use GPU: cuda:1
>>>>>>>start training : ETTh1_720_336_SegRNN_ETTh1_ftS_sl720_pl336_dm256_dr0.5_rtgru_dwpmf_sl48_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 1.2929270267486572
Epoch: 1, Steps: 29 | Train Loss: 0.4541321 Vali Loss: 0.3487535 Test Loss: 0.2850521
Validation loss decreased (inf --> 0.348754).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.2680413722991943
Epoch: 2, Steps: 29 | Train Loss: 0.3886904 Vali Loss: 0.2896765 Test Loss: 0.2253225
Validation loss decreased (0.348754 --> 0.289677).  Saving model ...
Updating learning rate to 0.0005
Epoch: 3 cost time: 1.2161710262298584
Epoch: 3, Steps: 29 | Train Loss: 0.3494928 Vali Loss: 0.2802866 Test Loss: 0.2145802
Validation loss decreased (0.289677 --> 0.280287).  Saving model ...
Updating learning rate to 0.0005
Epoch: 4 cost time: 1.2544469833374023
Epoch: 4, Steps: 29 | Train Loss: 0.3361784 Vali Loss: 0.2753697 Test Loss: 0.2127925
Validation loss decreased (0.280287 --> 0.275370).  Saving model ...
Updating learning rate to 0.0004
Epoch: 5 cost time: 1.2218279838562012
Epoch: 5, Steps: 29 | Train Loss: 0.3281195 Vali Loss: 0.2780611 Test Loss: 0.2152929
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003200000000000001
Epoch: 6 cost time: 1.2601442337036133
Epoch: 6, Steps: 29 | Train Loss: 0.3210143 Vali Loss: 0.2808123 Test Loss: 0.2101409
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00025600000000000004
Epoch: 7 cost time: 1.21705961227417
Epoch: 7, Steps: 29 | Train Loss: 0.3152857 Vali Loss: 0.2868317 Test Loss: 0.2119195
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00020480000000000004
Epoch: 8 cost time: 1.2359840869903564
Epoch: 8, Steps: 29 | Train Loss: 0.3109108 Vali Loss: 0.2905165 Test Loss: 0.2126255
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00016384000000000006
Epoch: 9 cost time: 1.256730079650879
Epoch: 9, Steps: 29 | Train Loss: 0.3065759 Vali Loss: 0.2943377 Test Loss: 0.2134031
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_720_336_SegRNN_ETTh1_ftS_sl720_pl336_dm256_dr0.5_rtgru_dwpmf_sl48_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.0722409039735794, mae:0.21279248595237732, ms/sample:0.5064039661280064
